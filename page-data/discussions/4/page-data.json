{"componentChunkName":"component---src-templates-discussion-detail-js","path":"/discussions/4/","result":{"data":{"allGitHubDiscussion":{"nodes":[{"number":4,"title":"How to surface a visible High-Risk Medication indicator on the Patient Chart (Medications) via Canvas plugins","body":"Context and Goal\r\n\r\nI am trying to implement a clear, visible indicator for high-risk medications directly on the patient chart, ideally in or adjacent to the Medications section. The primary goal is to make high-risk medications immediately obvious to clinicians at the point of care.\r\n\r\nAt this stage, I am not attempting anything complex. I am deliberately starting with a minimal “proof-of-life” approach to confirm that Canvas supports rendering something visible that is driven by medication data.\r\n\r\nMy first priority is simply:\r\n- When medications are present on a chart, surface some visible signal if one or more are considered high-risk.\r\n\r\nAcceptable initial outcomes would include:\r\n- A protocol card that reliably appears when medications are viewed (most ideal)\r\n- A banner, warning, or indicator near the Medications section\r\n- Any supported Canvas UI surface that renders in response to medication data\r\n\r\nI am not yet concerned with persistence, scoring, clinical logic depth, or UX polish.\r\n\r\n**What I Have Done So Far**\r\n\r\n1. Clean rebuild of the plugin from scratch\r\n\r\nTo eliminate any packaging or path issues, I completely deleted the plugin and rebuilt it from a clean directory.\r\n\r\nCurrent structure:\r\n\r\nC:\\canvas_plugins\\wovenly_high_risk_meds\\\r\n  CANVAS_MANIFEST.json\r\n  wovenly_high_risk_meds\\\r\n    __init__.py\r\n    protocols\\\r\n      __init__.py\r\n      high_risk_meds.py\r\n\r\n\r\nAll __init__.py files are present.\r\n\r\n2. Minimal, schema-valid CANVAS_MANIFEST.json\r\n\r\nThe manifest validates successfully once required fields (notably tags) are included.\r\n\r\n{\r\n  \"sdk_version\": \"0.7.0\",\r\n  \"plugin_version\": \"0.1.0\",\r\n  \"name\": \"wovenly_high_risk_meds\",\r\n  \"description\": \"Wovenly high risk medication grouping and protocol surfacing.\",\r\n  \"license\": \"Proprietary\",\r\n  \"readme\": false,\r\n  \"tags\": {\r\n    \"patient_sourcing_and_intake\": [],\r\n    \"interaction_modes_and_utilization\": [],\r\n    \"diagnostic_range_and_inputs\": [],\r\n    \"pricing_and_payments\": [],\r\n    \"care_team_composition\": [],\r\n    \"interventions_and_safety\": [],\r\n    \"content\": []\r\n  },\r\n  \"components\": {\r\n    \"protocols\": [\r\n      {\r\n        \"class\": \"wovenly_high_risk_meds.protocols.high_risk_meds:Protocol\",\r\n        \"description\": \"Proof of life on PATIENT_CHART__MEDICATIONS.\",\r\n        \"data_access\": {\r\n          \"event\": \"PATIENT_CHART__MEDICATIONS\",\r\n          \"read\": [],\r\n          \"write\": []\r\n        }\r\n      }\r\n    ]\r\n  }\r\n}\r\n\r\n3. Minimal protocol implementation (proof-of-life only)\r\n\r\nThe protocol is intentionally minimal. Its sole purpose is to confirm:\r\n- The module imports correctly\r\n- The protocol loads\r\n- The protocol’s compute() method runs when expected\r\n\r\nfrom __future__ import annotations\r\n\r\nimport logging\r\nfrom typing import List\r\n\r\nfrom canvas_sdk.effects.base import Effect\r\nfrom canvas_sdk.protocols.protocol import Protocol as BaseProtocol\r\n\r\nlogger = logging.getLogger(__name__)\r\n\r\n\r\nclass Protocol(BaseProtocol):\r\n    def compute(self) -> List[Effect]:\r\n        logger.info(\r\n            \"wovenly_high_risk_meds Protocol.compute ran for PATIENT_CHART__MEDICATIONS\"\r\n        )\r\n        return []\r\n\r\n\r\nNo UI effects are returned yet. I am only trying to confirm execution.\r\n\r\n4. Installation and enablement\r\n\r\nI install and enable the plugin using:\r\n\r\ncanvas.exe install --host wovenly-dev C:\\canvas_plugins\\wovenly_high_risk_meds\r\ncanvas.exe enable --host wovenly-dev wovenly_high_risk_meds\r\n\r\n\r\nThe plugin enables successfully.\r\n\r\n**Observed Behavior**\r\nWhat works\r\n- The plugin installs once the manifest schema issues are resolved\r\n- The plugin enables successfully\r\n- The plugin runner continues to operate normally\r\n- Other existing plugins load and run without issue\r\n\r\n**What does not work**\r\n\r\nI repeatedly see module import errors in the plugin runner logs:\r\n\r\nModuleNotFoundError: Could not load module\r\n\"wovenly_high_risk_meds.protocols.high_risk_meds\"\r\n\r\nWhen this occurs, the protocol never loads and compute() never runs\r\n\r\nEven when install and enable succeed, I do not see log output from this protocol\r\n\r\nLogs only show activity from unrelated protocols, for example:\r\n\r\nlob_dates_metadata Protocol.compute() completed\r\nwovenly_partner_profile_field Protocol.compute() completed\r\nResponded to Event PATIENT_METADATA__GET_ADDITIONAL_FIELDS\r\n\r\nI do not see any protocol card or UI element appear in the chart\r\n\r\nI do not see evidence that PATIENT_CHART__MEDICATIONS is triggering my protocol\r\n\r\n**Current Bottlenecks**\r\n1. Protocol module import reliability\r\n\r\nDespite:\r\n- Correct folder structure\r\n- Correct manifest class path\r\n- Clean rebuilds\r\n\r\nThe plugin runner intermittently fails to import the protocol module.\r\n\r\nI am looking for clarification on:\r\n- Whether protocol modules must follow a specific path pattern beyond what is documented\r\n- Whether import paths are rewritten during packaging\r\n- Whether Windows path behavior introduces known issues\r\n\r\n2. Event triggering expectations\r\n\r\nI am unclear on how reliably PATIENT_CHART__MEDICATIONS fires.\r\n\r\nQuestions:\r\n- Does this event fire on chart open, or only on create/update?\r\n- Is there a more reliable event for surfacing medication-adjacent UI?\r\n- Are there recommended alternatives for medication-driven rendering?\r\n\r\n3. Correct UI surface for medication indicators\r\n\r\nThis is the most important question.\r\n\r\nI want to confirm:\r\n- Whether Canvas supports visually annotating medications directly\r\n- Whether protocol cards are the intended surface for this use case\r\n- Whether a View or Application is more appropriate\r\n- Whether there are examples of medication-based indicators implemented today\r\n\r\nI am currently using protocols as the starting point, but I am not confident that this is the correct abstraction.\r\n\r\n**What I Am Asking For**\r\n- Confirmation of the recommended architecture for surfacing high-risk medication indicators\r\n- Clarification on supported UI surfaces tied to medications\r\n- Guidance on reliable event triggers for medication-driven UI\r\n- Any example plugins or references that demonstrate this pattern\r\n- Insight into common pitfalls around protocol imports and packaging\r\n\r\nIf there is a canonical approach that does not involve protocols, I would prefer to pivot now rather than continue building on the wrong abstraction.\r\n\r\nAny guidance or examples would be greatly appreciated.","state":"open","category":{"id":47304443,"name":"Q&A","slug":"q-a","emoji":":pray:"},"labels":[],"user":{"login":"drachamim","avatar_url":"https://avatars.githubusercontent.com/u/216191774?v=4"},"created_at":"2026-01-03T16:53:43Z","updated_at":"2026-01-03T16:53:43Z","comments":0,"url":"https://github.com/orgs/arkmsg/discussions/4"}]}},"pageContext":{"number":4}},"staticQueryHashes":["2249152690"],"slicesMap":{}}